<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>One-dimensional, steady-state, saturated flow &mdash; Amanzi 0.86-dev documentation</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.86-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Amanzi 0.86-dev documentation" href="../../index.html" />
    <link rel="up" title="Tutorial" href="../index.html" />
    <link rel="next" title="Tutorials" href="../transient_infiltration/Tutorial_dvz.html" />
    <link rel="prev" title="Tutorial" href="../index.html" /> 
 <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    TeX: {
        extensions: ["mhchem.js"]
    }
  });
</script>

  </head>
  <body role="document">

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../../index.html"><img src="../../_static/logo.png" border="0" alt="py4sci"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../transient_infiltration/Tutorial_dvz.html" title="Tutorials"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../index.html" title="Tutorial"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../search.html">search</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Tutorial</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">One-dimensional, steady-state, saturated flow</a><ul>
<li><a class="reference internal" href="#problem-definition">Problem definition</a></li>
<li><a class="reference internal" href="#amanzi-input-specifications"><em>Amanzi</em> input specifications</a></li>
<li><a class="reference internal" href="#amanzi-execution"><em>Amanzi</em> execution</a></li>
<li><a class="reference internal" href="#amanzi-results"><em>Amanzi</em> results</a></li>
<li><a class="reference internal" href="#amanzi-xml-input-file"><em>Amanzi</em> XML input file</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../index.html"
                        title="previous chapter">Tutorial</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../transient_infiltration/Tutorial_dvz.html"
                        title="next chapter">Tutorials</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/tutorial/steady_confined/Tutorial_steady_linear.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="one-dimensional-steady-state-saturated-flow">
<h1>One-dimensional, steady-state, saturated flow<a class="headerlink" href="#one-dimensional-steady-state-saturated-flow" title="Permalink to this headline">¶</a></h1>
<p>This tutorial uses a simple saturated flow simulation problem to demonstrate the
basic workflow required to create an input file, run <em>Amanzi</em>, and view results.</p>
<div class="section" id="problem-definition">
<h2>Problem definition<a class="headerlink" href="#problem-definition" title="Permalink to this headline">¶</a></h2>
<p>Consider the following steady-state saturated flow scenario:</p>
<a class="reference internal image-reference" href="../../_images/ProblemDefinition.png"><img alt="../../_images/ProblemDefinition.png" class="align-center" src="../../_images/ProblemDefinition.png" style="width: 470.4px; height: 194.25px;" /></a>
<p>Although the domain is three-dimensional, the imposed boundary conditions create a
one-dimensional flow in the <span class="math">\(x\)</span>-direction. The Darcy velocity is expected
to be <span class="math">\(U = 1.688\)</span> m/d = <span class="math">\(1.954 \times 10^{-5}\)</span> m/s throughout the domain
considering mass conservation. From Darcy&#8217;s law</p>
<blockquote>
<div><div class="math" id="equation-DarcysLaw">
<span class="eqno">(1)</span>\[U = \frac{\rho g k}{\mu} \cdot \frac{h_{in} - h_{out}}{L} = K \frac{h_{in} - h_{out}}{L}\]</div>
</div></blockquote>
<p>where <span class="math">\(K = \rho g k / \mu\)</span> is hydraulic conductivity,
the inlet hydraulic head corresponding to the prescribed inlet flux <span class="math">\(U\)</span> is</p>
<blockquote>
<div><div class="math" id="equation-inletHead">
<span class="eqno">(2)</span>\[h_{in} = \frac{U L}{K} + h_{out}\]</div>
</div></blockquote>
<p>Assuming <span class="math">\(\rho = 998.2\)</span> kg/m<sup>3</sup> and
<span class="math">\(\mu = 1.002 \times 10^{-3}\)</span> Pa <span class="math">\(\cdot\)</span> s for water at 20C, and
<span class="math">\(g = 9.807\)</span> m/s<sup>2</sup>,
the hydraulic conductivity of the porous medium is
<span class="math">\(K = 9.7698 \times 10^{-6}\)</span> m/s = <span class="math">\(0.844\)</span> m/d
and the computed hydraulic head at the inlet should be</p>
<blockquote>
<div><div class="math">
\[h_{in} = \frac{1.688 \text{ m/d} \cdot 100\text{ m}}{0.844 \text{ m/d}} + 120\text{ m} = 320 \text{ m}\]</div>
</div></blockquote>
<p>Analogous to Equation <a href="#equation-inletHead">(2)</a> the expected hydraulic head at an
arbitary location <span class="math">\(x\)</span> is</p>
<blockquote>
<div><div class="math" id="equation-observationHead">
<span class="eqno">(3)</span>\[h(x) = \frac{U (L - x)}{K} + h_{out}\]</div>
</div></blockquote>
<p>where <span class="math">\((L - x)\)</span> is the distance upgradient of the outlet.</p>
</div>
<div class="section" id="amanzi-input-specifications">
<h2><em>Amanzi</em> input specifications<a class="headerlink" href="#amanzi-input-specifications" title="Permalink to this headline">¶</a></h2>
<p><em>Amanzi</em> input takes the form of an eXtensible Markup Language (XML) file
with the extension <code class="docutils literal"><span class="pre">*.xml</span></code>. Although any text editor may be used to create or
edit the contents of the file, an editor that provides XML syntax-highlighting
improves readability and is helpful toward identifying syntax errors.
The following image is an example of XML syntax-highlighting in the <em>Notepad++</em>
editor for Microsoft Windows (<a class="reference external" href="http://notepad-plus-plus.org/">http://notepad-plus-plus.org/</a>):</p>
<a class="reference internal image-reference" href="../../_images/SyntaxHighlightingExample.png"><img alt="../../_images/SyntaxHighlightingExample.png" class="align-center" src="../../_images/SyntaxHighlightingExample.png" style="width: 503.5px; height: 153.0px;" /></a>
<p>The <em>Amanzi</em> input specification document (<strong>insert link</strong>) defines
the content and format of an XML input file. A complete <em>Amanzi</em> input file
for this tutorial is listed in a separate section below.
At the top level is an XML element named <code class="docutils literal"><span class="pre">amanzi_input</span></code></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;amanzi_input</span> <span class="na">version=</span><span class="s">&quot;2.0.0&quot;</span> <span class="na">type=</span><span class="s">&quot;unstructured&quot;</span><span class="nt">&gt;</span>

<span class="nt">&lt;/amanzi_input&gt;</span>
</pre></div>
</div>
<p>with an attribute <code class="docutils literal"><span class="pre">type</span></code> that defines the model grid type, either
<code class="docutils literal"><span class="pre">unstructured</span></code> or <code class="docutils literal"><span class="pre">structured</span></code>. A second attribute defines the <em>Amanzi</em> version.
Nested within this element are additional XML
elements with associated content and attributes to define other model inputs.
Model parameters are defined through a combination of element <em>attributes</em>,
e.g. <code class="docutils literal"><span class="pre">water</span></code> in the <code class="docutils literal"><span class="pre">liquid_phase</span></code> element,</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;liquid_phase</span> <span class="na">name=</span><span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>and element <em>content</em>, e.g. <code class="docutils literal"><span class="pre">998.2</span></code> kg/m<sup>3</sup> in the <code class="docutils literal"><span class="pre">density</span></code> element,</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;density&gt;</span>998.2<span class="nt">&lt;/density&gt;</span>
</pre></div>
</div>
<p>as defined by the <em>Amanzi</em> input specification.
Although not required by the XML standard or <em>Amanzi</em>,
indentation using tabs and/or spaces is commonly used to indicate
the hierarchy of elements and improve readibility. Tabs are used in this tutorial
example to show the file hierarchy. Although <em>Amanzi</em> XML element names and the
file structure are intended to be reasonably self-explanatory, selective commentary
is provided here for further guidance.</p>
<p><em>Amanzi</em> offers the user two numerical gridding approaches.
The <code class="docutils literal"><span class="pre">structured</span></code> grid option refers to an orthogonal grid of rectangular (2D) or
brick (3D) elements that may be further subdivided through
Adaptive Mesh Refinement (AMR). The <code class="docutils literal"><span class="pre">unstructured</span></code> grid option can accommodate a
network of non-orthogonal cells that may not be connected on a regular
pattern defined by <span class="math">\((i,j,k)\)</span> coordinate indices. The <code class="docutils literal"><span class="pre">unstructured</span></code>
option also accommodates structured grids, but not multi-level AMR as with the
<code class="docutils literal"><span class="pre">structured</span></code> grid option. A simple orthogonal structured grid with no refinement
will be used for this tutorial, and either gridding option would suffice.
However, the <code class="docutils literal"><span class="pre">unstructured</span></code> option is selected in this example through the
<code class="docutils literal"><span class="pre">type</span></code> attribute in the <code class="docutils literal"><span class="pre">amanzi_input</span></code> XML element:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;amanzi_input</span> <span class="na">version=</span><span class="s">&quot;2.0.0&quot;</span> <span class="na">type=</span><span class="s">&quot;unstructured&quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<p>Nested within the <code class="docutils literal"><span class="pre">amanzi_input</span></code> element are additional XML elements defining
various attributes of the numerical simulation to be performed. Although the order
of these elements is arbitrary, users will typically want to sequence elements to
mirror their conceptualization of the physical problem. For this tutorial we begin
with the <code class="docutils literal"><span class="pre">model_description</span></code> element:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;model_description</span> <span class="na">name=</span><span class="s">&quot;SR Test Problem&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;comments&gt;</span>Steady-State Saturated: linear pressure profile<span class="nt">&lt;/comments&gt;</span>
    <span class="nt">&lt;model_id&gt;</span>Single-Phase Saturated<span class="nt">&lt;/model_id&gt;</span>
    <span class="nt">&lt;author&gt;</span>Elizabeth Keating<span class="nt">&lt;/author&gt;</span>
    <span class="nt">&lt;units&gt;</span>
      <span class="nt">&lt;length_unit&gt;</span>m<span class="nt">&lt;/length_unit&gt;</span>
      <span class="nt">&lt;time_unit&gt;</span>s<span class="nt">&lt;/time_unit&gt;</span>
      <span class="nt">&lt;mass_unit&gt;</span>kg<span class="nt">&lt;/mass_unit&gt;</span>
      <span class="nt">&lt;conc_unit&gt;</span>molar<span class="nt">&lt;/conc_unit&gt;</span>
    <span class="nt">&lt;/units&gt;</span>
  <span class="nt">&lt;/model_description&gt;</span>
</pre></div>
</div>
<p>Besides model identification, this block defines the dimensional units to be used
for the numerical simulation. Currently <em>Amanzi</em> requires the SI units indicated
in the <code class="docutils literal"><span class="pre">model_description/units</span></code> element.
The units of density, viscosity, pressure, hydraulic conductivity, and
permeability  are thus kg/m<sup>3</sup>, Pa <span class="math">\(\cdot\)</span> s, Pa, m/s,
and m<sup>2</sup>, respectively.
Simulation outputs also use these dimensional units.</p>
<p>The next input block is the <code class="docutils literal"><span class="pre">process_kernels</span></code> element:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;process_kernels&gt;</span>
    <span class="nt">&lt;comments&gt;</span>Single phase flow only<span class="nt">&lt;/comments&gt;</span>
    <span class="nt">&lt;flow</span> <span class="na">state =</span> <span class="s">&quot;on&quot;</span> <span class="na">model =</span> <span class="s">&quot;saturated&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;transport</span> <span class="na">state =</span> <span class="s">&quot;off&quot;</span> <span class="na">algorithm=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;chemistry</span> <span class="na">state =</span> <span class="s">&quot;off&quot;</span> <span class="na">process_model=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/process_kernels&gt;</span>
</pre></div>
</div>
<p>The tutorial problem involves only fully-saturated flow, so the <code class="docutils literal"><span class="pre">saturated</span></code> model
is selected here, and transport and chemistry are explicitly turned <code class="docutils literal"><span class="pre">off</span></code>.
The latter may be implicitly turned off by omitting those two entries.</p>
<p>In the <code class="docutils literal"><span class="pre">phases</span></code> element</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;phases&gt;</span>
    <span class="nt">&lt;liquid_phase</span> <span class="na">name=</span><span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;eos&gt;</span>false<span class="nt">&lt;/eos&gt;</span>
      <span class="nt">&lt;density&gt;</span>998.2<span class="nt">&lt;/density&gt;</span>
      <span class="nt">&lt;viscosity&gt;</span>1.002E-03<span class="nt">&lt;/viscosity&gt;</span>
    <span class="nt">&lt;/liquid_phase&gt;</span>
  <span class="nt">&lt;/phases&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">water</span></code> is the only phase present (as a liquid), and
equation-of-state (eos) computations are turned off in favor of direct
specification of fluid density and viscosity as 998.2 kg/m<sup>3</sup>and 1.002e-03 Pa <span class="math">\(\cdot\)</span> s, respectively.</p>
<p>Under <code class="docutils literal"><span class="pre">execution_controls</span></code> the <code class="docutils literal"><span class="pre">steady</span></code> mode and first-order backward-difference
(backward Euler) differencing scheme (<code class="docutils literal"><span class="pre">bdf1</span></code>) are chosen:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;execution_controls&gt;</span>
    <span class="nt">&lt;verbosity</span> <span class="na">level=</span><span class="s">&quot;high&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;execution_control_defaults</span> <span class="na">mode=</span><span class="s">&quot;steady&quot;</span> <span class="na">method=</span><span class="s">&quot;bdf1&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;execution_control</span>  <span class="na">start=</span><span class="s">&quot;0.0&quot;</span> <span class="na">end=</span><span class="s">&quot;0.0&quot;</span> <span class="na">init_dt=</span><span class="s">&quot;1000&quot;</span> <span class="na">mode =</span> <span class="s">&quot;steady&quot;</span> <span class="na">method=</span><span class="s">&quot;bdf1&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/execution_controls&gt;</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">start</span></code> and <code class="docutils literal"><span class="pre">end</span></code> times may both be zero for a steady-state calculation.
Controls for the selected numerical scheme are defined in the block</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;numerical_controls&gt;</span>
    <span class="nt">&lt;linear_solver&gt;</span>
      <span class="nt">&lt;max_iterations&gt;</span>30<span class="nt">&lt;/max_iterations&gt;</span>
      <span class="nt">&lt;tolerance&gt;</span>1.0e-18<span class="nt">&lt;/tolerance&gt;</span>
    <span class="nt">&lt;/linear_solver&gt;</span>
  <span class="nt">&lt;/numerical_controls&gt;</span>
</pre></div>
</div>
<p>Here recommended default values have been selected.</p>
<p>The computational mesh may be imported (read from file) or, for simple geometries,
generated by <em>Amanzi</em>. A simple mesh is adequate for this simulation so the
latter option is selected for this tutorial example in the <code class="docutils literal"><span class="pre">mesh</span></code> element:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;mesh</span> <span class="na">framework=</span><span class="s">&quot;mstk&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;comments&gt;</span>Three-dimensional box 100m x 50m x 50m<span class="nt">&lt;/comments&gt;</span>
    <span class="nt">&lt;dimension&gt;</span>3<span class="nt">&lt;/dimension&gt;</span>
    <span class="nt">&lt;generate&gt;</span>
      <span class="nt">&lt;number_of_cells</span> <span class="na">nx =</span> <span class="s">&quot;100&quot;</span>  <span class="na">ny =</span> <span class="s">&quot;5&quot;</span>  <span class="na">nz =</span> <span class="s">&quot;50&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;box</span>  <span class="na">low_coordinates =</span> <span class="s">&quot;0.0,0.0,0.0&quot;</span> <span class="na">high_coordinates =</span> <span class="s">&quot;100.0,50.0,50.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/generate&gt;</span>
  <span class="nt">&lt;/mesh&gt;</span>
</pre></div>
</div>
<p>Note that a 3D domain is specified through the <code class="docutils literal"><span class="pre">dimension</span></code> element. The
coordinates under <code class="docutils literal"><span class="pre">mesh/generate/box</span></code> refer to the
<span class="math">\((x_{min}, y_{min}, z_{min})\)</span> and <span class="math">\((x_{max}, y_{max}, z_{max})\)</span>
corners of the computational domain, and must be
comma-separated. Whitespace is allowed and parentheses may be used to bracket
coordinates in the form <code class="docutils literal"><span class="pre">(x,y,z)</span></code> if desired. The <code class="docutils literal"><span class="pre">nx</span></code>, <code class="docutils literal"><span class="pre">ny</span></code>, and <code class="docutils literal"><span class="pre">nz</span></code>
values define the number of computational cells in each coordinate direction.
Discretization is specified for the <span class="math">\(y\)</span> and <span class="math">\(z\)</span> coordinates,
although no variability is expected in these directions.
The user could effectively create a one-dimensional simulation by setting
<code class="docutils literal"><span class="pre">ny</span> <span class="pre">=</span> <span class="pre">1</span></code> and <code class="docutils literal"><span class="pre">nz</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">regions</span></code> element is used to define volumes for material property assignments</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;regions&gt;</span>
    <span class="nt">&lt;comments&gt;&lt;/comments&gt;</span>
    <span class="nt">&lt;region</span> <span class="na">name =</span><span class="s">&quot;Entire Domain&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;comments&gt;</span>One region comprising the entire domain<span class="nt">&lt;/comments&gt;</span>
      <span class="nt">&lt;box</span> <span class="na">low_coordinates=</span> <span class="s">&quot;0.0,0.0,0.0&quot;</span>     <span class="na">high_coordinates=</span><span class="s">&quot;100.0,50.0,50.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/region&gt;</span>
</pre></div>
</div>
<p>surfaces for boundary condition assignments</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>    <span class="nt">&lt;region</span> <span class="na">name =</span><span class="s">&quot;Upstream&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;comments&gt;</span>Upstream boundary<span class="nt">&lt;/comments&gt;</span>
      <span class="nt">&lt;box</span> <span class="na">low_coordinates=</span> <span class="s">&quot;0.0,0.0,0.0&quot;</span>     <span class="na">high_coordinates=</span><span class="s">&quot;0.0,50.0,50.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/region&gt;</span>
</pre></div>
</div>
<p>and discrete points</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>    <span class="nt">&lt;point</span> <span class="na">name=</span><span class="s">&quot;Well 1&quot;</span>  <span class="na">coordinate=</span><span class="s">&quot;( 0.5, 25.0, 25.5)&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;point</span> <span class="na">name=</span><span class="s">&quot;Well 2&quot;</span>  <span class="na">coordinate=</span><span class="s">&quot;(50.5, 25.0, 25.5)&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;point</span> <span class="na">name=</span><span class="s">&quot;Well 2t&quot;</span> <span class="na">coordinate=</span><span class="s">&quot;(50.5, 25.0, 49.5)&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;point</span> <span class="na">name=</span><span class="s">&quot;Well 2b&quot;</span> <span class="na">coordinate=</span><span class="s">&quot;(50.5, 25.0,  0.5)&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;point</span> <span class="na">name=</span><span class="s">&quot;Well 3&quot;</span>  <span class="na">coordinate=</span><span class="s">&quot;(99.5, 25.0, 25.5)&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/regions&gt;</span>
</pre></div>
</div>
<p>The location points are defined in anticipation of
hydraulic head and pressure observations to be specified below.
To avoid ambiguity and the need for interpolation,
the observation points are defined so that each
location coincides exactly with a grid node (computational cell center).
The grid spacing in the <span class="math">\(x\)</span>-direction is <span class="math">\(1.0\)</span> meter,
so cell centers are positioned at <span class="math">\(x_i = 0.5, 1.5, 2.5, ..., 99.5\)</span>.
Similarly, the <span class="math">\(y\)</span>-coordinates of grid
nodes are <span class="math">\(y_i = 5, 10, 15, 20,\)</span> and <span class="math">\(25\)</span>, and finally
<span class="math">\(z_i = 0.5, 1.5, 2.5, ..., 49.5\)</span>. Point <code class="docutils literal"><span class="pre">Well</span> <span class="pre">1</span></code> is located just inside the
inlet boundary near the center of the face. Point <code class="docutils literal"><span class="pre">Well</span> <span class="pre">3</span></code> is similarly located
one-half cell inside the downstream boundary. Point <code class="docutils literal"><span class="pre">Well</span> <span class="pre">2</span></code> is located near the
center of the domain (within one-half cell). Points <code class="docutils literal"><span class="pre">Well</span> <span class="pre">2t</span></code> and <code class="docutils literal"><span class="pre">Well</span> <span class="pre">2b</span></code> are
positioned above and below <code class="docutils literal"><span class="pre">Well</span> <span class="pre">2</span></code> at the top and bottom of the domain.</p>
<p>Although the simulation problem is steady-state, an initial condition is required
<strong>? why ?</strong>:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;initial_conditions&gt;</span>
    <span class="nt">&lt;initial_condition</span> <span class="na">name=</span><span class="s">&quot;Initial Condition&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;comments&gt;</span>Uniform pressure over entire domain<span class="nt">&lt;/comments&gt;</span>
      <span class="nt">&lt;assigned_regions&gt;</span>Entire Domain<span class="nt">&lt;/assigned_regions&gt;</span>
      <span class="nt">&lt;liquid_phase</span> <span class="na">name =</span> <span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;liquid_component</span> <span class="na">name =</span> <span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;pressure</span> <span class="na">value =</span> <span class="s">&quot;101325.0&quot;</span> <span class="na">function=</span><span class="s">&quot;uniform&quot;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/liquid_component&gt;</span>
      <span class="nt">&lt;/liquid_phase&gt;</span>
    <span class="nt">&lt;/initial_condition&gt;</span>
  <span class="nt">&lt;/initial_conditions&gt;</span>
</pre></div>
</div>
<p>The <em>Amanzi</em> <code class="docutils literal"><span class="pre">pressure</span></code> variable is absolute pressure.
Here atmospheric pressure(<code class="docutils literal"><span class="pre">101325.0</span></code> Pa) is specified  over the modeling domain
using the <code class="docutils literal"><span class="pre">Entire</span> <span class="pre">Domain</span></code> region specified above.</p>
<p>Next boundary conditions are specified as</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;boundary_conditions&gt;</span>
    <span class="nt">&lt;comments&gt;&lt;/comments&gt;</span>
    <span class="nt">&lt;boundary_condition</span> <span class="na">name =</span> <span class="s">&quot;Upstream BC&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;comments&gt;</span>Upstream boundary condition<span class="nt">&lt;/comments&gt;</span>
      <span class="nt">&lt;assigned_regions&gt;</span>Upstream<span class="nt">&lt;/assigned_regions&gt;</span>
      <span class="nt">&lt;liquid_phase</span> <span class="na">name =</span> <span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;liquid_component</span> <span class="na">name =</span> <span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;inward_mass_flux</span> <span class="na">start=</span><span class="s">&quot;0.0&quot;</span> <span class="na">function=</span> <span class="s">&quot;constant&quot;</span> <span class="na">value=</span><span class="s">&quot;1.95e-2&quot;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/liquid_component&gt;</span>
      <span class="nt">&lt;/liquid_phase&gt;</span>
    <span class="nt">&lt;/boundary_condition&gt;</span>
    
    <span class="nt">&lt;boundary_condition</span> <span class="na">name =</span> <span class="s">&quot;Downstream BC&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;assigned_regions&gt;</span>Downstream<span class="nt">&lt;/assigned_regions&gt;</span>
      <span class="nt">&lt;liquid_phase</span> <span class="na">name =</span> <span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;liquid_component</span> <span class="na">name =</span> <span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;hydrostatic</span> <span class="na">start=</span><span class="s">&quot;0.0&quot;</span> <span class="na">function=</span> <span class="s">&quot;constant&quot;</span> <span class="na">value=</span><span class="s">&quot;120.0&quot;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/liquid_component&gt;</span>
      <span class="nt">&lt;/liquid_phase&gt;</span>
    <span class="nt">&lt;/boundary_condition&gt;</span>
  <span class="nt">&lt;/boundary_conditions&gt;</span>
</pre></div>
</div>
<p>The boundary condition at <span class="math">\(x=0\)</span> is defined in the problem statement as a
volumetric flux <span class="math">\(U\)</span> [m<sup>3</sup>/m<sup>2</sup>d = m/d].
<em>Amanzi</em> currently requires boundary conditions of this type to be specified as
a mass flux, <span class="math">\(\rho U\)</span> [kg<sup>3</sup>/m<sup>2</sup>s].
Performing this calculation for <span class="math">\(\rho = 998.2\)</span> kg/m<sup>3</sup> and
<span class="math">\(U = 1.688\)</span> m/d = <span class="math">\(1.954 \times 10^{-5}\)</span> m/s
yields <code class="docutils literal"><span class="pre">1.95e-2</span></code> kg<sup>3</sup>/m<sup>2</sup>s for <code class="docutils literal"><span class="pre">inward_mass_flux</span></code>.</p>
<p>Material properties are defined in the <code class="docutils literal"><span class="pre">materials</span></code> element</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;materials&gt;</span>
    <span class="nt">&lt;material</span> <span class="na">name=</span><span class="s">&quot;Soil&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;comments&gt;</span>Homogeneous material properties throughout the entire domain<span class="nt">&lt;/comments&gt;</span>
      <span class="nt">&lt;mechanical_properties&gt;</span>
        <span class="nt">&lt;porosity</span> <span class="na">value=</span><span class="s">&quot;0.25&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/mechanical_properties&gt;</span>
      <span class="nt">&lt;permeability</span> <span class="na">x=</span><span class="s">&quot;1.0E-12&quot;</span> <span class="na">y=</span><span class="s">&quot;1.0E-12&quot;</span> <span class="na">z=</span><span class="s">&quot;1.0E-12&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;assigned_regions&gt;</span>Entire Domain<span class="nt">&lt;/assigned_regions&gt;</span>
    <span class="nt">&lt;/material&gt;</span>
  <span class="nt">&lt;/materials&gt;</span>
</pre></div>
</div>
<p>For this steady-state saturated flow-only simulation porosity does not affect
the solution and its value is arbitrarily set to 0.25. The <code class="docutils literal"><span class="pre">permeability</span></code> values
are intrinsic permeability <span class="math">\(k\)</span> [m<sup>2</sup>] rather than hydraulic
conductivity <span class="math">\(K = \rho g k / \mu\)</span> [m/s], which is sometimes loosely referred
to as &#8220;permeability&#8221;.</p>
<p>In the <code class="docutils literal"><span class="pre">definitions</span></code> element</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;definitions&gt;</span>
    <span class="nt">&lt;macros&gt;</span>
      <span class="nt">&lt;time_macro</span> <span class="na">name=</span><span class="s">&quot;Steady State&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;time&gt;</span>0.0<span class="nt">&lt;/time&gt;</span>
      <span class="nt">&lt;/time_macro&gt;</span>
    <span class="nt">&lt;/macros&gt;</span>	
  <span class="nt">&lt;/definitions&gt;</span>
</pre></div>
</div>
<p>the <code class="docutils literal"><span class="pre">time_macro</span></code> element defines the time at which
model observations will be written to output according to the
<code class="docutils literal"><span class="pre">output/observations</span></code> element that follows. Because the simulation is steady-state,
the <code class="docutils literal"><span class="pre">time</span></code> is set to zero.</p>
<p>The final input is the <code class="docutils literal"><span class="pre">output</span></code> block</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>  <span class="nt">&lt;output&gt;</span>
    <span class="nt">&lt;observations&gt;</span>
      <span class="nt">&lt;filename&gt;</span>observation.out<span class="nt">&lt;/filename&gt;</span>
      <span class="nt">&lt;liquid_phase</span> <span class="na">name=</span><span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;hydraulic_head&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 1<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/hydraulic_head&gt;</span>
	<span class="nt">&lt;hydraulic_head&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 2<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/hydraulic_head&gt;</span>
</pre></div>
</div>
<p><span class="math">\(\vdots\)</span></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>	<span class="nt">&lt;aqueous_pressure&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 1<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/aqueous_pressure&gt;</span>
	<span class="nt">&lt;aqueous_pressure&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 2<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/aqueous_pressure&gt;</span>
</pre></div>
</div>
<p><span class="math">\(\vdots\)</span></p>
<div class="highlight-xml"><div class="highlight"><pre><span></span>    <span class="nt">&lt;vis&gt;</span>
      <span class="nt">&lt;base_filename&gt;</span>steady-flow<span class="nt">&lt;/base_filename&gt;</span>
      <span class="nt">&lt;num_digits&gt;</span>5<span class="nt">&lt;/num_digits&gt;</span>
      <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
    <span class="nt">&lt;/vis&gt;</span>
  <span class="nt">&lt;/output&gt;</span>
</pre></div>
</div>
<p>Observations, to be written to <code class="docutils literal"><span class="pre">observations.out</span></code>, are requested for hydraulic head
and (absolute) pressure at the five well locations previously defined under
<code class="docutils literal"><span class="pre">regions/point</span></code>. The <code class="docutils literal"><span class="pre">vis</span></code> element specifies 5 significant figures for the
visualization file with prefix <code class="docutils literal"><span class="pre">steady-flow</span></code>.</p>
</div>
<div class="section" id="amanzi-execution">
<h2><em>Amanzi</em> execution<a class="headerlink" href="#amanzi-execution" title="Permalink to this headline">¶</a></h2>
<p><em>Amanzi</em> is executed from the command-line using this or analogous command for
the user&#8217;s specific installation:</p>
<p><code class="docutils literal"><span class="pre">mpirun</span> <span class="pre">-n</span> <span class="pre">4</span> <span class="pre">/ascem/amanzi/install/current/bin/amanzi</span> <span class="pre">--xml_schema=/ascem/amanzi/install/current/bin/amanzi.xsd</span> <span class="pre">--xml_file=amanzi_steady_linear-isv2.xml</span></code></p>
<p>Here execution using 4 processor cores is specified by <code class="docutils literal"><span class="pre">-n</span> <span class="pre">4</span></code>. Successful completion
is marked by <code class="docutils literal"><span class="pre">SIMULATION_SUCCESSFUL</span></code> followed by a timing summary</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Amanzi</span><span class="p">::</span><span class="n">SIMULATION_SUCCESSFUL</span>

<span class="o">**********************************************************</span>
<span class="o">***</span>                   <span class="n">Timing</span> <span class="n">Summary</span>                   <span class="o">***</span>
<span class="o">**********************************************************</span>
</pre></div>
</div>
</div>
<div class="section" id="amanzi-results">
<h2><em>Amanzi</em> results<a class="headerlink" href="#amanzi-results" title="Permalink to this headline">¶</a></h2>
<p>For the requested observation points, the following results are expected in terms
of hydraulic head (Equation <a href="#equation-observationHead">(3)</a>) and pressure
(<span class="math">\(P = (h - z)\rho g + P_{atm}\)</span>):</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="19%" />
<col width="27%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ID</th>
<th class="head">x (m)</th>
<th class="head">h (m)</th>
<th class="head">P (Pa)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Well 1</td>
<td>0.5</td>
<td>319.00</td>
<td>2974498</td>
</tr>
<tr class="row-odd"><td>Well 2</td>
<td>50.5</td>
<td>221.00</td>
<td>1995564</td>
</tr>
<tr class="row-even"><td>Well 2t</td>
<td>50.5</td>
<td>221.00</td>
<td>1760619</td>
</tr>
<tr class="row-odd"><td>Well 2b</td>
<td>50.5</td>
<td>221.00</td>
<td>2240297</td>
</tr>
<tr class="row-even"><td>Well 3</td>
<td>99.5</td>
<td>121.00</td>
<td>1036208</td>
</tr>
</tbody>
</table>
<p>In output file <code class="docutils literal"><span class="pre">observations.out</span></code>, <em>Amanzi</em> produces the following results:</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="19%" />
<col width="27%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ID</th>
<th class="head">x (m)</th>
<th class="head">h (m)</th>
<th class="head">P (Pa)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Well 1</td>
<td>0.5</td>
<td>318.96</td>
<td>2974022</td>
</tr>
<tr class="row-odd"><td>Well 2</td>
<td>50.5</td>
<td>218.98</td>
<td>1995310</td>
</tr>
<tr class="row-even"><td>Well 2t</td>
<td>50.5</td>
<td>218.98</td>
<td>1760374</td>
</tr>
<tr class="row-odd"><td>Well 2b</td>
<td>50.5</td>
<td>218.98</td>
<td>2240035</td>
</tr>
<tr class="row-even"><td>Well 3</td>
<td>99.5</td>
<td>121.00</td>
<td>1036172</td>
</tr>
</tbody>
</table>
<p>The output from <em>Amanzi</em> is observed to agree closely with the expected hydraulic
head and pressure results from the analytic solution.</p>
</div>
<div class="section" id="amanzi-xml-input-file">
<h2><em>Amanzi</em> XML input file<a class="headerlink" href="#amanzi-xml-input-file" title="Permalink to this headline">¶</a></h2>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;amanzi_input</span> <span class="na">version=</span><span class="s">&quot;2.0.0&quot;</span> <span class="na">type=</span><span class="s">&quot;unstructured&quot;</span><span class="nt">&gt;</span>

  <span class="nt">&lt;model_description</span> <span class="na">name=</span><span class="s">&quot;SR Test Problem&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;comments&gt;</span>Steady-State Saturated: linear pressure profile<span class="nt">&lt;/comments&gt;</span>
    <span class="nt">&lt;model_id&gt;</span>Single-Phase Saturated<span class="nt">&lt;/model_id&gt;</span>
    <span class="nt">&lt;author&gt;</span>Elizabeth Keating<span class="nt">&lt;/author&gt;</span>
    <span class="nt">&lt;units&gt;</span>
      <span class="nt">&lt;length_unit&gt;</span>m<span class="nt">&lt;/length_unit&gt;</span>
      <span class="nt">&lt;time_unit&gt;</span>s<span class="nt">&lt;/time_unit&gt;</span>
      <span class="nt">&lt;mass_unit&gt;</span>kg<span class="nt">&lt;/mass_unit&gt;</span>
      <span class="nt">&lt;conc_unit&gt;</span>molar<span class="nt">&lt;/conc_unit&gt;</span>
    <span class="nt">&lt;/units&gt;</span>
  <span class="nt">&lt;/model_description&gt;</span>

  <span class="nt">&lt;process_kernels&gt;</span>
    <span class="nt">&lt;comments&gt;</span>Single phase flow only<span class="nt">&lt;/comments&gt;</span>
    <span class="nt">&lt;flow</span> <span class="na">state =</span> <span class="s">&quot;on&quot;</span> <span class="na">model =</span> <span class="s">&quot;saturated&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;transport</span> <span class="na">state =</span> <span class="s">&quot;off&quot;</span> <span class="na">algorithm=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;chemistry</span> <span class="na">state =</span> <span class="s">&quot;off&quot;</span> <span class="na">process_model=</span><span class="s">&quot;none&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/process_kernels&gt;</span>
  
  <span class="nt">&lt;phases&gt;</span>
    <span class="nt">&lt;liquid_phase</span> <span class="na">name=</span><span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;eos&gt;</span>false<span class="nt">&lt;/eos&gt;</span>
      <span class="nt">&lt;density&gt;</span>998.2<span class="nt">&lt;/density&gt;</span>
      <span class="nt">&lt;viscosity&gt;</span>1.002E-03<span class="nt">&lt;/viscosity&gt;</span>
    <span class="nt">&lt;/liquid_phase&gt;</span>
  <span class="nt">&lt;/phases&gt;</span>

  <span class="nt">&lt;execution_controls&gt;</span>
    <span class="nt">&lt;verbosity</span> <span class="na">level=</span><span class="s">&quot;high&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;execution_control_defaults</span> <span class="na">mode=</span><span class="s">&quot;steady&quot;</span> <span class="na">method=</span><span class="s">&quot;bdf1&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;execution_control</span>  <span class="na">start=</span><span class="s">&quot;0.0&quot;</span> <span class="na">end=</span><span class="s">&quot;0.0&quot;</span> <span class="na">init_dt=</span><span class="s">&quot;1000&quot;</span> <span class="na">mode =</span> <span class="s">&quot;steady&quot;</span> <span class="na">method=</span><span class="s">&quot;bdf1&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/execution_controls&gt;</span>
  
  <span class="nt">&lt;numerical_controls&gt;</span>
    <span class="nt">&lt;linear_solver&gt;</span>
      <span class="nt">&lt;max_iterations&gt;</span>30<span class="nt">&lt;/max_iterations&gt;</span>
      <span class="nt">&lt;tolerance&gt;</span>1.0e-18<span class="nt">&lt;/tolerance&gt;</span>
    <span class="nt">&lt;/linear_solver&gt;</span>
  <span class="nt">&lt;/numerical_controls&gt;</span>
  
  <span class="nt">&lt;mesh</span> <span class="na">framework=</span><span class="s">&quot;mstk&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;comments&gt;</span>Three-dimensional box 100m x 50m x 50m<span class="nt">&lt;/comments&gt;</span>
    <span class="nt">&lt;dimension&gt;</span>3<span class="nt">&lt;/dimension&gt;</span>
    <span class="nt">&lt;generate&gt;</span>
      <span class="nt">&lt;number_of_cells</span> <span class="na">nx =</span> <span class="s">&quot;100&quot;</span>  <span class="na">ny =</span> <span class="s">&quot;5&quot;</span>  <span class="na">nz =</span> <span class="s">&quot;50&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;box</span>  <span class="na">low_coordinates =</span> <span class="s">&quot;0.0,0.0,0.0&quot;</span> <span class="na">high_coordinates =</span> <span class="s">&quot;100.0,50.0,50.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/generate&gt;</span>
  <span class="nt">&lt;/mesh&gt;</span>
  
  <span class="nt">&lt;regions&gt;</span>
    <span class="nt">&lt;comments&gt;&lt;/comments&gt;</span>
    <span class="nt">&lt;region</span> <span class="na">name =</span><span class="s">&quot;Entire Domain&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;comments&gt;</span>One region comprising the entire domain<span class="nt">&lt;/comments&gt;</span>
      <span class="nt">&lt;box</span> <span class="na">low_coordinates=</span> <span class="s">&quot;0.0,0.0,0.0&quot;</span>     <span class="na">high_coordinates=</span><span class="s">&quot;100.0,50.0,50.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/region&gt;</span>
    <span class="nt">&lt;region</span> <span class="na">name =</span><span class="s">&quot;Upstream&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;comments&gt;</span>Upstream boundary<span class="nt">&lt;/comments&gt;</span>
      <span class="nt">&lt;box</span> <span class="na">low_coordinates=</span> <span class="s">&quot;0.0,0.0,0.0&quot;</span>     <span class="na">high_coordinates=</span><span class="s">&quot;0.0,50.0,50.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/region&gt;</span>
    <span class="nt">&lt;region</span> <span class="na">name =</span><span class="s">&quot;Downstream&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;comments&gt;</span>Downstream boundary<span class="nt">&lt;/comments&gt;</span>
      <span class="nt">&lt;box</span> <span class="na">low_coordinates=</span> <span class="s">&quot;100.0,0.0,0.0&quot;</span>     <span class="na">high_coordinates=</span><span class="s">&quot;100.0,50.0,50.0&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/region&gt;</span>
    <span class="nt">&lt;point</span> <span class="na">name=</span><span class="s">&quot;Well 1&quot;</span>  <span class="na">coordinate=</span><span class="s">&quot;( 0.5, 25.0, 25.5)&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;point</span> <span class="na">name=</span><span class="s">&quot;Well 2&quot;</span>  <span class="na">coordinate=</span><span class="s">&quot;(50.5, 25.0, 25.5)&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;point</span> <span class="na">name=</span><span class="s">&quot;Well 2t&quot;</span> <span class="na">coordinate=</span><span class="s">&quot;(50.5, 25.0, 49.5)&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;point</span> <span class="na">name=</span><span class="s">&quot;Well 2b&quot;</span> <span class="na">coordinate=</span><span class="s">&quot;(50.5, 25.0,  0.5)&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;point</span> <span class="na">name=</span><span class="s">&quot;Well 3&quot;</span>  <span class="na">coordinate=</span><span class="s">&quot;(99.5, 25.0, 25.5)&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/regions&gt;</span>

  <span class="nt">&lt;initial_conditions&gt;</span>
    <span class="nt">&lt;initial_condition</span> <span class="na">name=</span><span class="s">&quot;Initial Condition&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;comments&gt;</span>Uniform pressure over entire domain<span class="nt">&lt;/comments&gt;</span>
      <span class="nt">&lt;assigned_regions&gt;</span>Entire Domain<span class="nt">&lt;/assigned_regions&gt;</span>
      <span class="nt">&lt;liquid_phase</span> <span class="na">name =</span> <span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;liquid_component</span> <span class="na">name =</span> <span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;pressure</span> <span class="na">value =</span> <span class="s">&quot;101325.0&quot;</span> <span class="na">function=</span><span class="s">&quot;uniform&quot;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/liquid_component&gt;</span>
      <span class="nt">&lt;/liquid_phase&gt;</span>
    <span class="nt">&lt;/initial_condition&gt;</span>
  <span class="nt">&lt;/initial_conditions&gt;</span>
  
  <span class="nt">&lt;boundary_conditions&gt;</span>
    <span class="nt">&lt;comments&gt;&lt;/comments&gt;</span>
    <span class="nt">&lt;boundary_condition</span> <span class="na">name =</span> <span class="s">&quot;Upstream BC&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;comments&gt;</span>Upstream boundary condition<span class="nt">&lt;/comments&gt;</span>
      <span class="nt">&lt;assigned_regions&gt;</span>Upstream<span class="nt">&lt;/assigned_regions&gt;</span>
      <span class="nt">&lt;liquid_phase</span> <span class="na">name =</span> <span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;liquid_component</span> <span class="na">name =</span> <span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;inward_mass_flux</span> <span class="na">start=</span><span class="s">&quot;0.0&quot;</span> <span class="na">function=</span> <span class="s">&quot;constant&quot;</span> <span class="na">value=</span><span class="s">&quot;1.95e-2&quot;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/liquid_component&gt;</span>
      <span class="nt">&lt;/liquid_phase&gt;</span>
    <span class="nt">&lt;/boundary_condition&gt;</span>
    
    <span class="nt">&lt;boundary_condition</span> <span class="na">name =</span> <span class="s">&quot;Downstream BC&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;assigned_regions&gt;</span>Downstream<span class="nt">&lt;/assigned_regions&gt;</span>
      <span class="nt">&lt;liquid_phase</span> <span class="na">name =</span> <span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;liquid_component</span> <span class="na">name =</span> <span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	  <span class="nt">&lt;hydrostatic</span> <span class="na">start=</span><span class="s">&quot;0.0&quot;</span> <span class="na">function=</span> <span class="s">&quot;constant&quot;</span> <span class="na">value=</span><span class="s">&quot;120.0&quot;</span><span class="nt">/&gt;</span>
	<span class="nt">&lt;/liquid_component&gt;</span>
      <span class="nt">&lt;/liquid_phase&gt;</span>
    <span class="nt">&lt;/boundary_condition&gt;</span>
  <span class="nt">&lt;/boundary_conditions&gt;</span>
  
  <span class="nt">&lt;materials&gt;</span>
    <span class="nt">&lt;material</span> <span class="na">name=</span><span class="s">&quot;Soil&quot;</span><span class="nt">&gt;</span>
      <span class="nt">&lt;comments&gt;</span>Homogeneous material properties throughout the entire domain<span class="nt">&lt;/comments&gt;</span>
      <span class="nt">&lt;mechanical_properties&gt;</span>
        <span class="nt">&lt;porosity</span> <span class="na">value=</span><span class="s">&quot;0.25&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/mechanical_properties&gt;</span>
      <span class="nt">&lt;permeability</span> <span class="na">x=</span><span class="s">&quot;1.0E-12&quot;</span> <span class="na">y=</span><span class="s">&quot;1.0E-12&quot;</span> <span class="na">z=</span><span class="s">&quot;1.0E-12&quot;</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;assigned_regions&gt;</span>Entire Domain<span class="nt">&lt;/assigned_regions&gt;</span>
    <span class="nt">&lt;/material&gt;</span>
  <span class="nt">&lt;/materials&gt;</span>

  <span class="nt">&lt;definitions&gt;</span>
    <span class="nt">&lt;macros&gt;</span>
      <span class="nt">&lt;time_macro</span> <span class="na">name=</span><span class="s">&quot;Steady State&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;time&gt;</span>0.0<span class="nt">&lt;/time&gt;</span>
      <span class="nt">&lt;/time_macro&gt;</span>
    <span class="nt">&lt;/macros&gt;</span>	
  <span class="nt">&lt;/definitions&gt;</span>
  
  <span class="nt">&lt;output&gt;</span>
    <span class="nt">&lt;observations&gt;</span>
      <span class="nt">&lt;filename&gt;</span>observation.out<span class="nt">&lt;/filename&gt;</span>
      <span class="nt">&lt;liquid_phase</span> <span class="na">name=</span><span class="s">&quot;water&quot;</span><span class="nt">&gt;</span>
	<span class="nt">&lt;hydraulic_head&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 1<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/hydraulic_head&gt;</span>
	<span class="nt">&lt;hydraulic_head&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 2<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/hydraulic_head&gt;</span>
	<span class="nt">&lt;hydraulic_head&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 2t<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/hydraulic_head&gt;</span>
	<span class="nt">&lt;hydraulic_head&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 2b<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/hydraulic_head&gt;</span>
	<span class="nt">&lt;hydraulic_head&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 3<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/hydraulic_head&gt;</span>
	
	<span class="nt">&lt;aqueous_pressure&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 1<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/aqueous_pressure&gt;</span>
	<span class="nt">&lt;aqueous_pressure&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 2<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/aqueous_pressure&gt;</span>
	<span class="nt">&lt;aqueous_pressure&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 2t<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/aqueous_pressure&gt;</span>
	<span class="nt">&lt;aqueous_pressure&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 2b<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/aqueous_pressure&gt;</span>
	<span class="nt">&lt;aqueous_pressure&gt;</span>
	  <span class="nt">&lt;assigned_regions&gt;</span>Well 3<span class="nt">&lt;/assigned_regions&gt;</span>
	  <span class="nt">&lt;functional&gt;</span>point<span class="nt">&lt;/functional&gt;</span>
	  <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
	<span class="nt">&lt;/aqueous_pressure&gt;</span>
      <span class="nt">&lt;/liquid_phase&gt;</span>
    <span class="nt">&lt;/observations&gt;</span>
    <span class="nt">&lt;vis&gt;</span>
      <span class="nt">&lt;base_filename&gt;</span>steady-flow<span class="nt">&lt;/base_filename&gt;</span>
      <span class="nt">&lt;num_digits&gt;</span>5<span class="nt">&lt;/num_digits&gt;</span>
      <span class="nt">&lt;time_macro&gt;</span>Steady State<span class="nt">&lt;/time_macro&gt;</span>
    <span class="nt">&lt;/vis&gt;</span>
  <span class="nt">&lt;/output&gt;</span>
  
<span class="nt">&lt;/amanzi_input&gt;</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../transient_infiltration/Tutorial_dvz.html" title="Tutorials"
             >next</a> |</li>
        <li class="right" >
          <a href="../index.html" title="Tutorial"
             >previous</a> |</li>
        <li><a href="../../index.html">home</a>|&nbsp;</li>
        <li><a href="../../search.html">search</a>|&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../index.html" >Tutorial</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Amanzi Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>